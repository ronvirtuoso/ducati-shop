define(["jquery","mage/url"],function($,url){let categories={container:".main-categories-static-content",childCategoriesSelector:".menu-left-category-link-hover",categoryChildContainer:".category-content-right",categoryContentSelector:".parent-category-content",staticBlockSelector:".block-static-block",categoryContent:null,previousCategory:null,activeCategory:null,categoriesContentRequested:[],classFadeIn:'fade-content-in',classFadeOut:'fade-content-out',init:function(){this.addOnMouseEnterLeaveAction()},addOnMouseEnterLeaveAction:function(){let self=this;$(document).on('mouseenter',self.container+' '+self.childCategoriesSelector,function(event){$(this).addClass('active-menu-link').siblings(categories.childCategoriesSelector).removeClass('active-menu-link').addClass('non-active-menu-link');let categoryId=$(this).data('category-id');self.setCategoryContent($(this),categoryId);if($('.menu-left-category-link-hover').hasClass('non-active-menu-link')){$(this.categoryChildContainer).removeClass(this.classFadeIn);}else{$(this.categoryChildContainer).addClass(this.classFadeIn);}
self.switchContentBlock($(this),categoryId);});$(document).on('mouseleave',self.container+' '+self.childCategoriesSelector,function(event){$(self.childCategoriesSelector).removeClass('non-active-menu-link').addClass('active-menu-link');let newElement=event.toElement||event.relatedTarget;if($(newElement).is('li')){self.hideCurrentCategoryContent($(this))}else{self.switchContentBlockToParent($(this));}});},getCategoryContentContainer:function(categoryId){return $("li[data-category-id='"+categoryId+"'] .category-content-right").removeClass(this.classFadeOut).addClass(this.classFadeIn);},appendContent:function(newContent,categoryId){this.getCategoryContentContainer(categoryId).html(newContent).addClass(this.classFadeOut);this.switchContentBlock(this.getCategoryContentContainer(categoryId),categoryId);},callCategoryContentController:function(link,categoryId){let self=this;let categoriesCmsBlockUrl=url.build('/ducati/categories/cmsblock?category_id='+categoryId);$.ajax({url:categoriesCmsBlockUrl,type:'GET',jsonp:false,complete:function(response){if(response.responseJSON.success==='true'){self.categoriesContentRequested.push(categoryId)
self.appendContent(response.responseJSON.data,categoryId)}else{self.switchContentBlockToParent(link)}},error:function(xhr,status,errorThrown){self.switchContentBlockToParent(link)
console.error('Error: '+errorThrown+'(category id: '+categoryId+')');return null;}});},setCategoryContent:function(link,categoryId){if(this.categoriesContentRequested.indexOf(categoryId)===-1){this.callCategoryContentController(link,categoryId)}
this.activeCategory=categoryId;},switchContentBlock:function(link,categoryId){if(this.activeCategory===categoryId&&this.categoriesContentRequested.indexOf(categoryId)!==-1){this.getCategoryContentContainer(categoryId).removeClass(this.classFadeOut).addClass(this.classFadeIn);$(this.categoryContentSelector).removeClass(this.classFadeIn).addClass(this.classFadeOut);}},switchContentBlockToParent:function(link){link.children(this.categoryChildContainer).removeClass(this.classFadeIn).addClass(this.classFadeOut);$(this.categoryContentSelector).removeClass(this.classFadeOut).addClass(this.classFadeIn);},hideCurrentCategoryContent:function(link){link.children(this.categoryChildContainer).removeClass(this.classFadeIn).addClass(this.classFadeOut);}};return categories.init();})